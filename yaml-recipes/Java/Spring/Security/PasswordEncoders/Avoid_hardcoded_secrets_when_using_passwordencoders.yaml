id: scw:spring:security:hardcoded-secrets
version: 8
metadata:
  name: Avoid hardcoded secrets when using password encoders
  shortDescription: Using passwordencoders in combination with hardcoded secrets is
    security sensitive
  level: error
  language: java
  scwCategory: broken_cryptography
  enabled: true
  descriptionFile: descriptions/Avoidhardcodedsecretswhenusingpasswordencoders.html
search:
  methodcall:
    args:
      1:
        containsUntrustedInput: false
        type: java.lang.String
    name: encode
    anyOf:
    - type: org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder
    - type: org.springframework.security.crypto.scrypt.SCryptPasswordEncoder
    - type: org.springframework.security.crypto.password.Pbkdf2PasswordEncoder
    - type: org.springframework.security.crypto.argon2.Argon2PasswordEncoder
    - type: org.springframework.security.crypto.password.PasswordEncoder
availableFixes:
- name: Retrieve the password from an environment variable
  actions:
  - modifyArguments:
      rewrite:
        1: System.getenv("PASSWORD")

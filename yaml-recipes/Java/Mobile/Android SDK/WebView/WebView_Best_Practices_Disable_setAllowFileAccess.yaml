id: scw:android:disable-file-access
version: 8
metadata:
  name: 'Android WebView best practices: Disable setAllowFileAccess'
  shortDescription: Enabling this WebView setting has security implications
  level: error
  language: java
  scwCategory: ""
  enabled: false
  comment: Quickfix to be implemented!
  descriptionFile: descriptions/AndroidWebViewbestpractices.html
  tags: android-security-set
search:
  instanceCreation:
    not:
      followedBy:
        methodcall:
          name:
            matches: setAllowFileAccess
          "on":
            methodcall:
              name: getSettings
              "on":
                instanceCreation: {}
    type: android.webkit.WebView
availableFixes:
- name: Fix the code by ...
  actions:
  - rewrite:
      to: ""
      target: self

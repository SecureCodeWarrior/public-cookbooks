<html>
<body>
<h2>Abstract</h2>
Secure coding practices prescribe to securely store encryption keys by using the <code>KeyStore</code> API.
<h2>Description</h2>
Most cryptographic keys, such as instances of a secret key or a private key should be stored securely. This is not valid for public keys, which can be distributed safely. The confidentiality of encrypted data depends on the secrecy of these keys used. <br>
In order to securely store encryption keys it is recommended to use the <code>KeyStore</code> API provided by Java.
<h4>Class information:</h4>
<pre>
<b>java.security.KeyStore</b>
    load(InputStream, char[])
    getKey(String, char[])
    setEntry(String, Key, KeyStore.ProtectionParameter)
    store(OutputStream, char[])
</pre>

<h3>Create a KeyStore</h3>
In order to create a KeyStore the algorithm needs to be chosen, it is recommended to use <code>JCEKS</code>. Use the <code>load</code> method to load a keystore
<h4>Correct code example:</h4>
<pre>
File f = new Files("KeyStoreFile.jks");
KeyStore keyStore = <b>KeyStore.getInstance("JCEKS")</b>;
keyStore.load(null, password.toCharArray());
FileOutputStream fos = new FileOutputStream(KEY_STORE_FILENAME);
keyStore.store(fos, password.toCharArray());
fos.close();
</pre>

<h3>Add a key to the keystore</h3>

<h4>Correct code example:</h4>
<pre>
KeyStore.ProtectionParameter protParam =
                new KeyStore.PasswordProtection(password.toCharArray());
KeyStore.SecretKeyEntry skEntry = new KeyStore.SecretKeyEntry(key);
keyStore.<b>setEntry(KEY_ALIAS, skEntry, protParam)</b>;
</pre>

<!-- Sources:
http://www.java-redefined.com/2013/08/symmetric-key-encryption-decryption-keytool.html (source 2003??)
https://docs.oracle.com/javase/7/docs/api/java/security/KeyStore.html

JCEKS uses Triple DES encryption: https://www.pixelstech.net/article/1408345768-Different-types-of-keystore-in-Java----Overview
BouncyCastle is a different providor, we also recommend this one in Android and it is now standard included in Android:
Howver this uses Triple DES Variation as well: PBEWithSHAAnd3-KeyTripleDES-CBC -> Seems standard

JCEKS seems a good way to store Secret Keys (JKS is sufficient if only public and private keys are needed it seems)
 -->     
        <h2>Violating this guideline can cause</h2>
        
        
        <h4>Web vulnerabilities</h4>
            <ul>
            
                <li>Insecure Cryptography - Exposed Key. <a href="https://{{microtraininghost}}/#/simple-flow/web/crypto/exposedkey/java/undefined?utm_source=sensei&utm_content=problemdescription">Learn more</a></li>
            </ul>
        
    
        <h2>Sensei quick fix</h2>
        <p>Use the <b>Sensei&reg; Quick Fix technology: Hit {{{ qfshortcut }}}</b> to fix this guideline violation automatically.</p>

</body>
</html>
<html>
<body>
<h2>Abstract</h2>
Secure coding practices prescribe to send CSRF tokens as a request parameter and compare them with a session-stored token.
<h2>Description</h2>
It is recommended to use a secure random token (e.g., CSRF token) for any state changing operation.
Characteristics of a CSRF Token:
<ul>
<li>Unique per user session</li>
<li>Large random value</li>
<li>Generated by a cryptographically secure random number generator</li>
<li>The CSRF token is added as a hidden field for forms or within the URL if the state changing operation occurs via a GET</li>
<li>The server rejects the requested action if the CSRF token fails validation</li>
</ul>
<h4>Correct code example:</h4>
<pre>
String newToken = csrfTokenRepository.generateToken(request);
request.setAttribute("csrfTokenParam", csrfTokenRepository.getParameterName());
request.setAttribute("csrfToken", newToken);
</pre>
Using a cookie does not work. All cookies, even the secret ones, will be submitted with every request. All authentication tokes will be submitted regardless of whether or not the end-user was tricked into submitting the request. Furthermore, session identifiers are simply used by the application container to associate the request with a specific session object. The session identifier does not verify that the end-user intended to submit the request.     
        <h2>Violating this guideline can cause</h2>
        
        
        <h4>Web vulnerabilities</h4>
            <ul>
            
                <li>Cross Site Request Forgery - Cross Site Request Forgery. <a href="https://{{microtraininghost}}/#/simple-flow/web/csrf/csrf/java/spring?utm_source=sensei&utm_content=problemdescription">Learn more</a></li>
                <li>Session Handling - Cross Site Request Forgery. <a href="https://{{microtraininghost}}/#/simple-flow/web/session/csrf/java/spring?utm_source=sensei&utm_content=problemdescription">Learn more</a></li>
            </ul>
        
    
        <h2>Sensei quick fix</h2>
        <p>Use the <b>Sensei&reg; Quick Fix technology: Hit {{{ qfshortcut }}}</b> to fix this guideline violation automatically.</p>

</body>
</html>
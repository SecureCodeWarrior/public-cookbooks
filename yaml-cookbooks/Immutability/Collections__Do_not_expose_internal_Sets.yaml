id: 71453156-ec12-4181-9aa0-a427e040dcc5
version: 8
metadata:
  name: 'Collections: Do not expose internal Sets'
  shortDescription: Do not expose an internal Set as it is mutable. Return a copy
    or immutable view.
  level: marked_information
  scwCategory: ""
  enabled: true
  descriptionFile: DonotexposeinternalCollection-set.html
search:
  return:
    in:
      typeDeclaration:
        member:
          field:
            modifier:
              matches: (private|protected)
            name: '{{{returnValue.name}}}'
            type:
              reference:
                matches: java.util.Set.*
              checkInheritance: true
    value:
      reference:
        name: '{{{returnValue.name}}}'
availableFixes:
- name: Return an unmodifiable Set
  actions:
  - rewrite:
      to: return java.util.Collections.unmodifiableSet({{{ returnValue }}});

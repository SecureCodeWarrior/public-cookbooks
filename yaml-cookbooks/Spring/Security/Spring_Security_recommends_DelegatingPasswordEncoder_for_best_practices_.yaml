id: be170b97-b870-498c-843e-e3351e6d48ec
metadata:
  name: 'Spring Security recommends DelegatingPasswordEncoder for best practices '
  shortDescription: DelegatingPasswordEncoder allows more flexibility when using several
    encoders, for code changes, and for migrating
  level: info
  scwCategory: ""
  enabled: true
  descriptionFile: SpringSecurityrecommendsDelegatePasswordEncoderforbestpractices.html
search:
  assignment:
    not:
      in:
        method:
          annotation:
            type: Bean
          returnType: '{{{ type }}}'
    anyOf:
    - expressionType: org.springframework.security.crypto.password.Pbkdf2PasswordEncoder
    - expressionType: org.springframework.security.crypto.scrypt.SCryptPasswordEncoder
    - expressionType: org.springframework.security.crypto.argon2.Argon2PasswordEncoder
availableFixes:
- name: Create a custom instance of DelegatingPasswordEncoder
  actions:
  - rewrite:
      to: |-
        java.util.Map<String, org.springframework.security.crypto.password.PasswordEncoder> encoders = new java.util.HashMap<>();
        encoders.put("{{#sed}}s/passwordencoder//g,{{#lowerCase}}{{{ typeElement }}}{{/lowerCase}}{{/sed}}", {{{ assignedExpression }}});

        org.springframework.security.crypto.password.PasswordEncoder {{{ qualifier }}} = new org.springframework.security.crypto.password.DelegatingPasswordEncoder("{{#sed}}s/passwordencoder//g,{{#lowerCase}}{{{ typeElement }}}{{/lowerCase}}{{/sed}}", encoders);
      target: self

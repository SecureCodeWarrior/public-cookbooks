id: 81543c6a-e23c-471c-919d-3e93b572bf6e
metadata:
  name: Avoid hardcoded secrets when using passwordencoders
  shortDescription: Using passwordencoders in combination with hardcoded secrets is
    security sensitive
  level: error
  scwCategory: broken_cryptography
  enabled: true
  descriptionFile: Avoidhardcodedsecretswhenusingpasswordencoders.html
search:
  methodcall:
    args:
      1:
        containsUntrustedInput: false
        type: java.lang.String
    name: encode
    anyOf:
    - type: org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder
    - type: org.springframework.security.crypto.scrypt.SCryptPasswordEncoder
    - type: org.springframework.security.crypto.password.Pbkdf2PasswordEncoder
    - type: org.springframework.security.crypto.argon2.Argon2PasswordEncoder
    - type: org.springframework.security.crypto.password.PasswordEncoder
availableFixes:
- name: Retrieve the password from an environment variable
  actions:
  - modifyArguments:
      rewrite:
        1: System.getenv("PASSWORD")

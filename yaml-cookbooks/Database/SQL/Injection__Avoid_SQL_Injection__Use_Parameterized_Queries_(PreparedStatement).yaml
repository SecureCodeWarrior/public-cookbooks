id: b23dd92f-229c-4886-b6fa-e4486c24be0a
version: 8
metadata:
  name: 'Injection: Avoid SQL Injection: Use Parameterized Queries (PreparedStatement)'
  shortDescription: Could lead to SQL Injection
  level: error
  newCodeOnly: false
  scwCategory: injection
  enabled: true
  comment: ""
  overridingRecipeId: ""
search:
  methodcall:
    args:
      1:
        containsUntrustedInput: true
        type: java.lang.String
    name: prepareStatement
    type:
      reference: java.sql.Connection
      checkInheritance: false
availableFixes:
- name: Use parameterized queries
  actions:
  - parameterize:
      placeholderFormat: '?'
      extractUntrustedInput:
        methodsOnObject:
          methods:
          - type: java.lang.String
            methodName: setString
            args:
              "1": '{{{ index }}}'
              "2": '{{{ . }}}'
          - type: java.lang.Integer
            methodName: setInt
            args:
              "1": '{{{ index }}}'
              "2": '{{{ . }}}'
          - type: int
            methodName: setInt
            args:
              "1": '{{{ index }}}'
              "2": '{{{ . }}}'
          - type: double
            methodName: setDouble
            args:
              "1": '{{{ index }}}'
              "2": '{{{ . }}}'
          - type: java.lang.Double
            methodName: setDouble
            args:
              "1": '{{{ index }}}'
              "2": '{{{ . }}}'
          - type: float
            methodName: setFloat
            args:
              "1": '{{{ index }}}'
              "2": '{{{ . }}}'
          - type: java.lang.Float
            methodName: setFloat
            args:
              "1": '{{{ index }}}'
              "2": '{{{ . }}}'
          - type: boolean
            methodName: setBoolean
            args:
              "1": '{{{ index }}}'
              "2": '{{{ . }}}'
          - type: java.lang.Boolean
            methodName: setBoolean
            args:
              "1": '{{{ index }}}'
              "2": '{{{ . }}}'
          - type: java.lang.Short
            methodName: setShort
            args:
              "1": '{{{ index }}}'
              "2": '{{{ . }}}'
          - type: short
            methodName: setShort
            args:
              "1": '{{{ index }}}'
              "2": '{{{ . }}}'
          - type: java.sql.Time
            methodName: setTime
            args:
              "1": '{{{ index }}}'
              "2": '{{{ . }}}'
          - type: java.sql.TimeStamp
            methodName: setTimeStamp
            args:
              "1": '{{{ index }}}'
              "2": '{{{ . }}}'
          - type: java.net.URL
            methodName: setURL
            args:
              "1": '{{{ index }}}'
              "2": '{{{ . }}}'
          target:
            returnValue: {}

<h2>Abstract</h2>
When the httpOnly flag of a cookie was set to false, the cookie could potentially be vulnerable to scripts.
<h2>Description</h2>
A cookie can become vulnerable to Cross-Site Scripting (XSS) if the .httpOnly() flag was set to false. This means an attacker could access the cookie via JavaScript, steal it, and consequently impersonate another user.
Protect the cookie from scripts by setting the .httpOnly() flag to true.
<table><tr>
<th>Before</th>
<th>After</th>
</tr>
<tr>
<td><pre><span style="font-size:8px;">
    http
        .csrf()
        .csrfTokenRepository(CookieCsrfTokenRepository.withHttpOnlyFalse());</span></pre></td>
<td><pre><span style="font-size:8px;">
    CookieCsrfTokenRepository csrfTokenRepository = new CookieCsrfTokenRepository();
    csrfTokenRepository.setCookieHttpOnly(true);
    http
        .csrf().csrfTokenRepository(csrfTokenRepository);</span></pre></td>
</tr>
</table>
<h2>Resources</h2>
For more information
<ul>
    <li><a href="https://docs.spring.io/spring-security/site/docs/5.0.x/reference/html/csrf.html">Guide to Spring Security CSRF</a></li>
</ul>

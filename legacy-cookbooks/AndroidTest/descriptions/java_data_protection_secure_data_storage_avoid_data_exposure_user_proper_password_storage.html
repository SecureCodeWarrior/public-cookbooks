<html>
<body>
<h2>Abstract</h2>
Secure coding practices prescribe to design password storage assuming eventual compromise.
<h2>Description</h2>
It is recommended to design the password storage of your application assuming eventual compromise. Instead of storing the actual password, it is advised to store them in a protected form using the following techniques:
<ul>
<li><b>Use a one-way function:</b> A one-way function makes it so that when the protected form is compromised the attacker can not revert the transformation to find the actual password. Instead a brute force attack is needed that repeats the transform for all possible passwords until a match is found. Some good examples of adaptive one-way functions are (strongest to weakest): <b>Argon2</b>, PBKDF2, scrypt, bcrypt. </li>

<li><b>Use a cryptographically strong credential-specific salt:</b> A salt is a fixed-length strong random value. This value should be appended to the credential and the result should be used as input for the adaptive one-way function. The salt adds extra entropy to the credentials and guarantees that identical credentials result in different protected forms when stored. Use a strong cryptographic function to generate a salt, such as  <code>SecureRandom</code>. The salt should not be obscured or hidden but can be stored with the hashed credentials.</li>

<li><b>Use a cryptographically strong pepper:</b> A pepper performs a similar role to a salt, but while a salt is stored alongside the hashed output, a pepper is not. A pepper usually meets one of two criteria:
<ul>
<li>The pepper is at least as long as the salt and is stored separately from the value to be hashed, often as an application secret.</li>
<li>The pepper is small and randomly generated for each input to be hashed, and is never stored. To verify whether an input matches, the application iterates through the full set of possible values for the pepper (to avoid timing attacks), testing each resulting hash in turn.</li>
</ul></li></ul>
<h4>Correct code example:</h4>
In the example below the password hashing competition winner, Argon2 algorithm is used. The Java binding used in the example <a href="https://github.com/phxql/argon2-jvm/blob/develop/src/main/java/de/mkammerer/argon2/BaseArgon2.java#L70">generates the salt automatically</a> using <code>SecureRandom</code>. The pepper used in this implementation is a randomly generated application secret.
<pre>
private static final String PEPPER = "eafe33b387579123328e1da5d72f26337a9e2acf294a1fba5b259dc4254ba06a"
...
public static String hash(@NonNull String password, @NonNull Charset charset) {
    char[] credential = (password + PEPPER).toCharArray();
    String hash;
    Argon2 argon2Hasher = null;
    try {
        argon2Hasher = createInstance();
        hash = <b>argon2Hasher.hash</b>(ITERATIONS, MEMORY, THREADS, credential, charset);
    } finally {
        if (argon2Hasher != null) {
            argon2Hasher.wipeArray(credential);
        }
    }
    return hash;
}
</pre>
Recommended parameters for the example above are: <code>ITERATIONS=40</code>, <code>MEMORY=128000</code>, <code>THREADS=4</code>.
<!-- Sources
https://www.owasp.org/index.php/Password_Storage_Cheat_Sheet#Design_password_storage_assuming_eventual_compromise
https://github.com/P-H-C/phc-winner-argon2#bindings
https://en.wikipedia.org/wiki/Argon2https://github.com/phxql/argon2-jvm/blob/develop/src/main/java/de/mkammerer/argon2/BaseArgon2.java#L70 -->     
        <h2>Violating this guideline can cause</h2>
        
        <h4>Mobile vulnerabilities</h4>
            <ul>
            
                <li>Broken Cryptography - Use Of Insecure/Deprecated Algorithms. <a href="https://{{microtraininghost}}/#/simple-flow/mobile/broken_cryptography/use_of_insecuredeprecated_alogirthms/java/undefined?utm_source=sensei&utm_content=problemdescription">Learn more</a></li>
            </ul>
        
        
        <h4>Web vulnerabilities</h4>
            <ul>
            
                <li>Insecure Cryptography - Insufficiently Protected Credentials. <a href="https://{{microtraininghost}}/#/simple-flow/web/crypto/credentialexp/java/undefined?utm_source=sensei&utm_content=problemdescription">Learn more</a></li>
                <li>Insecure Cryptography - Insecure Randomness. <a href="https://{{microtraininghost}}/#/simple-flow/web/crypto/insecurerandomness/java/undefined?utm_source=sensei&utm_content=problemdescription">Learn more</a></li>
                <li>Insecure Cryptography - Other. <a href="https://{{microtraininghost}}/#/simple-flow/web/crypto/generic/java/undefined?utm_source=sensei&utm_content=problemdescription">Learn more</a></li>
                <li>Sensitive Data Storage - Plaintext Storage of Passwords. <a href="https://{{microtraininghost}}/#/simple-flow/web/ics/passwdstorage/java/undefined?utm_source=sensei&utm_content=problemdescription">Learn more</a></li>
                <li>Authentication - Insufficiently Protected Credentials. <a href="https://{{microtraininghost}}/#/simple-flow/web/auth/credentialexp/java/undefined?utm_source=sensei&utm_content=problemdescription">Learn more</a></li>
                <li>Information Exposure - Sensitive Data Exposure. <a href="https://{{microtraininghost}}/#/simple-flow/web/infoexposure/sensitiveinfo/java/undefined?utm_source=sensei&utm_content=problemdescription">Learn more</a></li>
            </ul>
        
    
        <h2>Sensei quick fix</h2>
        <p>Use the <b>Sensei&reg; Quick Fix technology: Hit {{{ qfshortcut }}}</b> to fix this guideline violation automatically.</p>

</body>
</html>
<html>
<body>
<h2>Abstract</h2>
Out of Java best practices and coding guidelines, recommendations where abstracted that recommend the usage of OWASP Enterprise Security API (ESAPI).
Only authorized routines from that library can be used for session management and handling account credentials.
As such, it is discouraged to generate and handle account credentials or session identifiers using standard java routines.
<h2>Description</h2>
It is not recommended to use the standard java implementation for session management as there is an OWASP ESAPI alternative.
More specific, one should use an implementation of the <code>Authenticator</code> interface for generating and handling account credentials and session identifiers.
Possible implementing classes of this interface are the <code>AbstractAuthenticator</code> and its extension <code>FileBasedAuthenticator</code>. 
Banned methods related to account credentials:
<ul>
    <li>BAN005:	<code>ServletRequest.getUserPrincipal</code></li>
    <li>BAN007:	<code>Session.invalidate</code></li>
</ul>
<h4>Correct code example:</h4>
<pre>
import org.owasp.esapi.<b>User</b>;
import org.owasp.esapi.reference.<b>FileBasedAuthenticator</b>;
...
User p = FileBasedAuthenticator.getInstance().getCurrentUser();
</pre>
<!--
<br/>
Fix this issue by using the <b>Sensei Security&reg; Quick Fix technology: Hit {{{ qfshortcut }}}</b> to automatically fix this issue.<br/>
<br/>

 3. Links targeting the developer 

<h2>Additional information for the developer</h2>

Please see the standard OWASP ESAPI documentation for more information:<br/>
<ul>
    <li>(WWW) <a href="https://static.javadoc.io/org.owasp.esapi/esapi/2.1.0/org/owasp/esapi/Authenticator.html" >OWASP ESAPI Javadoc: Authenticator</a>.</li>
	<li>(WWW) <a href="https://static.javadoc.io/org.owasp.esapi/esapi/2.1.0/org/owasp/esapi/reference/AbstractAuthenticator.html" >OWASP ESAPI Javadoc: AbstractAuthenticator</a>.</li>
	<li>(WWW) <a href="https://static.javadoc.io/org.owasp.esapi/esapi/2.1.0/org/owasp/esapi/reference/FileBasedAuthenticator.html" >OWASP ESAPI Javadoc: FileBasedAuthenticator</a>.</li>
	<li>(WWW) <a href="https://static.javadoc.io/org.owasp.esapi/esapi/2.1.0/org/owasp/esapi/Randomizer.html#getRandomString(int, char[])" >OWASP ESAPI Javadoc: Randomizer.getRandomString</a>.</li>
	<li>(WWW) <a href="https://damonmiller.github.io/esapi4cf/tutorials/Login.html" >Github Doman Miller: OWASP ESAPI4CF Authentication tutorial</a>.</li>
</ul>

 4. The security implications when doing it wrong, information for developer interested in security 
<h2>Additional security information</h2>
Web development frameworks, such as J2EE, ASP .NET, PHP, and others, provide their own session management features and associated implementation. It is recommended to use these built-in frameworks versus building a home made one from scratch, as they are used worldwide on multiple web environments and have been tested by the web application security and development communities over time.
</br>
However, be advised that these frameworks have also presented vulnerabilities and weaknesses in the past, so it is always recommended to use the latest version available, that potentially fixes all the well-known vulnerabilities, as well as review and change the default configuration to enhance its security by following the recommendations you can find in the following page.

<ul>
	<li>(WWW) <a href="https://www.owasp.org/index.php/Session_Management_Cheat_Sheet#Introduction">OWASP Session Management Cheat Sheet</a></li>
</ul>

<b>Security implications related to not following this guideline:</b>

<ul>
 <li>(WWW) <a href="https://www.owasp.org/index.php/ESAPI_Secure_Coding_Guideline">OWASP ESAPI Secure Coding Guideline</a></li>
    <li>(WWW) <a href="https://www.owasp.org/index.php/Top_10_2013-A2-Broken_Authentication_and_Session_Management">OWASP Top 10: A2: Broken Authentication and Session Management</a> </li>
</ul>


<br>
In case of questions on the usage of the OWASP ESAPI, please contact: {{{ appsecmail }}}<br>
In case of feedback on this pugin, please contact Sensei Security: productfeedback@senseisecurity.com<br>


 -->     
        <h2>Violating this guideline can cause</h2>
        
        
        <h4>Web vulnerabilities</h4>
            <ul>
            
                <li>Authentication - Improper Authentication. <a href="https://{{microtraininghost}}/#/simple-flow/web/auth/missingauth/java/undefined?utm_source=sensei&utm_content=problemdescription">Learn more</a></li>
                <li>Access Control - Missing Function Level Access Control. <a href="https://{{microtraininghost}}/#/simple-flow/web/access/functionlevel/java/undefined?utm_source=sensei&utm_content=problemdescription">Learn more</a></li>
                <li>Authentication - Insecure Password Change Function. <a href="https://{{microtraininghost}}/#/simple-flow/web/auth/passwordchange/java/undefined?utm_source=sensei&utm_content=problemdescription">Learn more</a></li>
                <li>Authentication - Insecure Password Reset Function. <a href="https://{{microtraininghost}}/#/simple-flow/web/auth/passwordreset/java/undefined?utm_source=sensei&utm_content=problemdescription">Learn more</a></li>
                <li>Authentication - Weak Password Policy. <a href="https://{{microtraininghost}}/#/simple-flow/web/auth/weakpolicy/java/undefined?utm_source=sensei&utm_content=problemdescription">Learn more</a></li>
                <li>Session Handling - Cross Site Request Forgery. <a href="https://{{microtraininghost}}/#/simple-flow/web/session/csrf/java/undefined?utm_source=sensei&utm_content=problemdescription">Learn more</a></li>
                <li>Session Handling - Exposed Session Tokens. <a href="https://{{microtraininghost}}/#/simple-flow/web/session/exposedtokens/java/undefined?utm_source=sensei&utm_content=problemdescription">Learn more</a></li>
                <li>Session Handling - Insufficient Session Expiration. <a href="https://{{microtraininghost}}/#/simple-flow/web/session/sessionexp/java/undefined?utm_source=sensei&utm_content=problemdescription">Learn more</a></li>
                <li>Session Handling - Weak Session Token Generation. <a href="https://{{microtraininghost}}/#/simple-flow/web/session/weaksessionexp/java/undefined?utm_source=sensei&utm_content=problemdescription">Learn more</a></li>
                <li>Session Handling - Other. <a href="https://{{microtraininghost}}/#/simple-flow/web/session/generic/java/undefined?utm_source=sensei&utm_content=problemdescription">Learn more</a></li>
            </ul>
        
    
        <h2>Sensei quick fix</h2>
        <p>Use the <b>Sensei&reg; Quick Fix technology: Hit {{{ qfshortcut }}}</b> to fix this guideline violation automatically.</p>

</body>
</html>